import{d as r,_ as j}from"./index-ByB2dbry.js";r({root:document.getElementById("cell-2"),expanded:[],variables:[]},{id:2,body:async()=>({d3:await j(()=>import("https://cdn.jsdelivr.net/npm/d3@7/+esm"),[])}),inputs:[],outputs:["d3"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-4"),expanded:[],variables:[]},{id:4,body:()=>({points:[[0,0],[1,4],[2,0],[3,0],[4,2],[5,4]]}),inputs:[],outputs:["points"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-5"),expanded:[],variables:[]},{id:5,body:(a,t)=>({show:a(t.checkbox(["Nearest","B-spline","Hermite","Monotonic","derivatives"],{value:["Nearest","B-spline","Hermite","Monotonic"]}))}),inputs:["view","Inputs"],outputs:["show"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-6"),expanded:[],variables:[]},{id:6,body:()=>({height:400}),inputs:[],outputs:["height"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-7"),expanded:[],variables:[]},{id:7,body:()=>{function a(t,c,l=200){const n=new Array(l);for(let i=0;i<l;i++)n[i]=t+(c-t)*i/(l-1);return n}return{linspace:a}},inputs:[],outputs:["linspace"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-8"),expanded:[],variables:[]},{id:8,body:()=>{function a(t){return[1/6*(1-t)**3,1/6*(3*t**3-6*t**2+4),1/6*(-3*t**3+3*t**2+3*t+1),1/6*t**3]}return{bsplineBasis:a}},inputs:[],outputs:["bsplineBasis"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-9"),expanded:[],variables:[]},{id:9,body:()=>{function a(t){return[1/2*(-(t**3)+2*t**2-t),1/2*(3*t**3-5*t**2+2),1/2*(-3*t**3+4*t**2+t),1/2*(t**3-t**2)]}return{hermiteBasis:a}},inputs:[],outputs:["hermiteBasis"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-10"),expanded:[],variables:[]},{id:10,body:()=>({monotoneCubic:function(){function t(l){return l<0?-1:1}function c(l,n,i){var d=n-l,u=i-n;return(t(d)+t(u))*Math.min(Math.abs(d),Math.abs(u),.25*Math.abs(d+u))}return function(n,i,d,u,h){let g=c(n,i,d),x=c(i,d,u),v=d-i;return i+g*h+(3*v-2*g-x)*h**2+(g+x-2*v)*h**3}}()}),inputs:[],outputs:["monotoneCubic"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-11"),expanded:[],variables:[]},{id:11,body:(a,t,c,l,n,i,d,u,h,g,x)=>{{let w=function(){E(),I();const e=o.selectAll("g").data(a);e.enter().append("g").call(s=>s.append("circle").attr("r",30).attr("fill","none")).call(s=>s.append("circle").attr("r",0).attr("stroke","black").attr("stroke-width",1.5).transition().duration(750).ease(t.easeElastic).attr("r",5)).merge(e).attr("transform",s=>`translate(${p(s[0])},${m(s[1])})`).select("circle:last-child").attr("fill",s=>s===v?"lightblue":"black"),e.exit().remove()},E=function(){~n.indexOf("Nearest")&&(o.select("path.nearest1").datum(a.map(e=>[[e[0]-.5,e[1]],[e[0]+.5,e[1]]]).flat()).attr("d",t.line().x(e=>p(e[0])).y(e=>m(e[1])).defined(e=>!!e)),o.select("path.nearest2").datum(a.map(e=>[[e[0]-.5,e[1]],[e[0]+.5,e[1]]]).map(e=>[e,null]).flat().flat()).attr("d",t.line().x(e=>p(e[0])).y(e=>m(e[1])).defined(e=>!!e)))},k=function(e,s){const f=a,b=[-1,0,1,2].map($=>Math.min(Math.max(0,Math.floor(e+$)),a.length-1)),y=s((e+1)%1);return y[0]*f[b[0]][1]+y[1]*f[b[1]][1]+y[2]*f[b[2]][1]+y[3]*f[b[3]][1]},B=function(e,s){const f=a,b=[-1,0,1,2].map(y=>Math.min(Math.max(0,Math.floor(e+y)),a.length-1));return i(f[b[0]][1],f[b[1]][1],f[b[2]][1],f[b[3]][1],(e+1)%1)},_=function(e,s,f=.01){return(e(s+f)-e(s-f))/(2*f)},I=function(){~n.indexOf("B-spline")&&(o.select("path.cubicspline").datum(d(...p.domain())).attr("d",t.line().x(e=>p(e)).y(e=>m(k(e,u)))),o.select("path.cubicspline-slope").datum(d(...p.domain())).attr("d",t.line().x(e=>p(e)).y(e=>m(_(s=>k(s,u),e))))),~n.indexOf("Monotonic")&&(o.select("path.monotone").datum(d(...p.domain())).attr("d",t.line().x(e=>p(e)).y(e=>m(B(e)))),o.select("path.monotone-slope").datum(d(...p.domain())).attr("d",t.line().x(e=>p(e)).y(e=>m(_(s=>B(s),e))))),~n.indexOf("Hermite")&&(o.select("path.cubic").datum(d(...p.domain())).attr("d",t.line().x(e=>p(e)).y(e=>m(k(e,h)))),o.select("path.cubic-slope").datum(d(...p.domain())).attr("d",t.line().x(e=>p(e)).y(e=>m(_(s=>k(s,h),e)))))},M=function(e){return e.sourceEvent.target.__data__},C=function({subject:e}){v=e,w()},W=function(e){e.subject[1]=m.invert(e.y),w()},v=a[0];const p=t.scaleLinear().domain([-.5,5.5]).range([0,c]),m=t.scaleLinear().domain([-2,5]).range([l,0]),o=t.create("svg").attr("viewBox",[-14,0,c+28,l]).attr("tabindex",1).attr("pointer-events","all").call(t.drag().subject(M).on("start",C).on("drag",W));o.append("rect").attr("fill","none").attr("width",c).attr("height",l),o.append("path").attr("class","nearest1").attr("fill","none").attr("stroke","grey").attr("stroke-dasharray","4 4").attr("stroke-width",1),o.append("path").attr("class","nearest2").attr("fill","none").attr("stroke","black").attr("stroke-width",2),o.append("path").attr("class","cubic").attr("fill","none").attr("stroke","#38f").attr("stroke-width",3),o.append("path").attr("class","monotone").attr("fill","none").attr("stroke","#3d8").attr("stroke-width",3),o.append("path").attr("class","cubicspline").attr("fill","none").attr("stroke","#f38").attr("stroke-width",3),~n.indexOf("derivatives")&&(o.append("path").attr("class","axis").attr("fill","none").attr("stroke","gray").attr("stroke-dasharray","2 2").attr("stroke-width",2).datum([[-10,0],[10,0]]).attr("d",t.line().x(e=>p(e[0])).y(e=>m(e[1]))),o.append("path").attr("class","cubic-slope").attr("fill","none").attr("stroke","#38f").attr("stroke-dasharray","2 2").attr("stroke-width",2),o.append("path").attr("class","monotone-slope").attr("fill","none").attr("stroke","#3d8").attr("stroke-dasharray","2 2").attr("stroke-width",2),o.append("path").attr("class","cubicspline-slope").attr("fill","none").attr("stroke","#f38").attr("stroke-dasharray","2 2").attr("stroke-width",2)),w(),g(x`
<figure style="max-width:100%">
  ${o.node()}
  <figcaption><span style="color:#f38">B-spline</span> undershoots, <span style="color:#38f">Hermite</span> overshoots, and <span style="color:#3d8">monotone</span> clips slopes to stay in between.</figcaption>
</figure>
`)}},inputs:["points","d3","width","height","show","monotoneCubic","linspace","bsplineBasis","hermiteBasis","display","html"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-12"),expanded:[],variables:[]},{id:12,body:(a,t)=>a`## B-spline

B-spline interpolation treats data points as control points. It can be computed via repeated linear interpolation ([De Casteljau's algorithm](https://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm)), which keeps all weights in ${t`[0, 1]`}. This makes it efficient on GPUs using hardware linear filtering. See *[GPU Gems Chapter 20](https://developer.nvidia.com/gpugems/gpugems2/part-iii-high-quality-rendering/chapter-20-fast-third-order-texture-filtering)* and my notebook [Bicubic Texture Interpolation using Linear Filtering](https://rreusser.github.io/notebooks/bicubic-texture-interpolation-using-linear-filtering/).`,inputs:["md","tex"],outputs:[],output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:void 0});r({root:document.getElementById("cell-13"),expanded:[],variables:[]},{id:13,body:(a,t)=>a`The four basis function weights in the interval ${t`[0, 1]`} are`,inputs:["md","tex"],outputs:[],output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:void 0});r({root:document.getElementById("cell-14"),expanded:[],variables:[]},{id:14,body:(a,t)=>a(t.block`f(u) = \frac{1}{6}
\begin{bmatrix}
(1-u)^3 \\
3u^3 - 6u^2 + 4 \\
-3u^3 + 3u^2 + 3u + 1 \\
u^3
\end{bmatrix}`),inputs:["display","tex"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-15"),expanded:[],variables:[]},{id:15,body:(a,t,c,l,n)=>{{const i=a(0,1,101).map(d=>{const u=t(d);return{u:d,b0:u[0],b1:u[1],b2:u[2],b3:u[3]}});c(l`<figure>
  ${n.plot({width:384,height:256,grid:!0,x:{domain:[0,1]},y:{domain:[-.1,1]},marks:[n.ruleX([0,1]),n.ruleY([0]),n.line(i,{x:"u",y:"b0",stroke:"#d38",strokeWidth:2}),n.line(i,{x:"u",y:"b1",stroke:"#8d3",strokeWidth:2}),n.line(i,{x:"u",y:"b2",stroke:"#38d",strokeWidth:2}),n.line(i,{x:"u",y:"b3",stroke:"#d83",strokeWidth:2})]})}
  <figcaption>B-spline basis functions. The maximum is 2/3, causing undershoot.</figcaption>
  </figure>`)}},inputs:["linspace","bsplineBasis","display","html","Plot"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-17"),expanded:[],variables:[]},{id:17,body:(a,t)=>a`The four basis function weights in the interval ${t`[0, 1]`} are`,inputs:["md","tex"],outputs:[],output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:void 0});r({root:document.getElementById("cell-18"),expanded:[],variables:[]},{id:18,body:(a,t)=>a(t.block`f(u) = \frac{1}{2}
\begin{bmatrix}
-u^3 + 2u^2 - u \\
3u^3 - 5u^2 + 2 \\
-3u^3 + 4u^2 + u \\
u^3 - u^2
\end{bmatrix}`),inputs:["display","tex"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-19"),expanded:[],variables:[]},{id:19,body:(a,t,c,l,n)=>{{const i=a(0,1,101).map(d=>{const u=t(d);return{u:d,b0:u[0],b1:u[1],b2:u[2],b3:u[3]}});c(l`<figure>${n.plot({width:384,height:256,grid:!0,x:{domain:[0,1]},y:{domain:[-.1,1]},marks:[n.ruleX([0,1]),n.ruleY([0]),n.line(i,{x:"u",y:"b0",stroke:"#d38",strokeWidth:2}),n.line(i,{x:"u",y:"b1",stroke:"#8d3",strokeWidth:2}),n.line(i,{x:"u",y:"b2",stroke:"#38d",strokeWidth:2}),n.line(i,{x:"u",y:"b3",stroke:"#d83",strokeWidth:2})]})}
  <figcaption>Hermite basis functions. Negative weights cause overshoot.</figcaption>
  </figure>`)}},inputs:["linspace","hermiteBasis","display","html","Plot"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});r({root:document.getElementById("cell-21"),expanded:[],variables:[]},{id:21,body:(a,t)=>a(t.block`
\begin{aligned}
s_0 &= f_1 - f_0 \\
s_1 &= f_2 - f_1 \\
f'_1 &= (\operatorname{sign}(s_0) + \operatorname{sign}(s_1))
\operatorname{min}\left(\left|s_0\right|, \left|s_1\right|, \left|\frac{s_0 + s_1}{4}\right|\right) \\
\Delta &= f_2 - f_1 \\
f(u) &= f_1 + f'_1 u + (3\Delta - 2f'_1 - f'_2) u^2 + (f'_1 + f'_2 - 2\Delta) u^3
\end{aligned}`),inputs:["display","tex"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});
