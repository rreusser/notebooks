async function m({optionalFeatures:n=[],maxBufferSizes:o=!1}={}){if(!navigator.gpu)throw new Error("WebGPU is not supported in this browser");const a=await navigator.gpu.requestAdapter();if(!a)throw new Error("Failed to get WebGPU adapter");const i=n.filter(t=>a.features.has(t)),s={};i.length>0&&(s.requiredFeatures=i),o&&(s.requiredLimits={maxStorageBufferBindingSize:a.limits.maxStorageBufferBindingSize,maxBufferSize:a.limits.maxBufferSize});const r=await a.requestDevice(s);r.lost.then(t=>{console.error("[WebGPU] Device lost:",t.message,t.reason)}),r.addEventListener?.("uncapturederror",t=>{console.error("[WebGPU] Uncaptured error:",t.error.message)});const g=r.createShaderModule.bind(r);r.createShaderModule=function(t){const c=g(t),f=t.label||"unnamed shader";return c.getCompilationInfo().then(d=>{for(const u of d.messages){const h=u.lineNum?` at line ${u.lineNum}:${u.linePos}`:"",l=`[WebGPU Shader "${f}"${h}] ${u.type}: ${u.message}`;u.type==="error"?console.error(l):u.type==="warning"?console.warn(l):console.info(l)}}),c};const e=navigator.gpu.getPreferredCanvasFormat();return{adapter:a,device:r,canvasFormat:e,features:new Set(i)}}function p(){return typeof navigator<"u"&&navigator.gpu!==void 0}function b(n,o,{pixelRatio:a=devicePixelRatio,alphaMode:i="opaque"}={}){return function({current:s,width:r,height:g}){let e,t;return s?(e=s,t=e._gpuContext):(e=document.createElement("canvas"),t=e.getContext("webgpu"),e._gpuContext=t,t.configure({device:n,format:o,alphaMode:i}),e.value={device:n,context:t,format:o}),e.width=Math.floor(r*a),e.height=Math.floor(g*a),e.style.width=`${r}px`,e.style.height=`${g}px`,e.style.position="absolute",e.style.top="0",e.style.left="0",t.configure({device:n,format:o,alphaMode:i}),e}}function w(n,o,a){const i=Math.min(n.xRange[0],n.xRange[1])*o,s=Math.min(n.yRange[0],n.yRange[1])*o,r=Math.abs(n.xRange[1]-n.xRange[0])*o,g=Math.abs(n.yRange[0]-n.yRange[1])*o;return{x:i,y:s,width:r,height:g}}export{m as createWebGPUContext,p as isWebGPUAvailable,w as webgpuAxesViewport,b as webgpuElement};
