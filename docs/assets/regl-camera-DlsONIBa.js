function N(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var U=function(f,t){t||(t=[0,""]),f=String(f);var n=parseFloat(f,10);return t[0]=n,t[1]=f.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t},B=U,R=Z,O=96,C={ch:8,ex:7.15625,em:16,rem:16,in:O,cm:O/2.54,mm:O/25.4,pt:O/72,pc:O/6,px:1};function Z(e){if(!e)return null;if(C[e])return C[e];var f=B(e);if(!isNaN(f[0])&&f[1]){var t=Z(f[1]);return typeof t=="number"?f[0]*t:null}return null}var G=R,J=K;function K(e,f,t){typeof e=="function"&&(t=!!f,f=e,e=window);var n=G("ex"),i=function(l){t&&l.preventDefault();var s=l.deltaX||0,v=l.deltaY||0,y=l.deltaZ||0,g=l.deltaMode,o=1;switch(g){case 1:o=n;break;case 2:o=window.innerHeight;break}if(s*=o,v*=o,y*=o,s||v||y)return f(s,v,y,l)};return e.addEventListener("wheel",i),i}var $=Q;function Q(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var T=V;function V(e,f,t,n,i){var l=1/Math.tan(f/2),s=1/(n-i);return e[0]=l/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*s,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*s,e[15]=0,e}var I=$,ee=ne;function ne(e,f,t,n){var i,l,s,v,y,g,o,h,p,a,X=f[0],m=f[1],w=f[2],Y=n[0],z=n[1],b=n[2],F=t[0],P=t[1],x=t[2];return Math.abs(X-F)<1e-6&&Math.abs(m-P)<1e-6&&Math.abs(w-x)<1e-6?I(e):(o=X-F,h=m-P,p=w-x,a=1/Math.sqrt(o*o+h*h+p*p),o*=a,h*=a,p*=a,i=z*p-b*h,l=b*o-Y*p,s=Y*h-z*o,a=Math.sqrt(i*i+l*l+s*s),a?(a=1/a,i*=a,l*=a,s*=a):(i=0,l=0,s=0),v=h*s-p*l,y=p*i-o*s,g=o*l-h*i,a=Math.sqrt(v*v+y*y+g*g),a?(a=1/a,v*=a,y*=a,g*=a):(v=0,y=0,g=0),e[0]=i,e[1]=v,e[2]=o,e[3]=0,e[4]=l,e[5]=y,e[6]=h,e[7]=0,e[8]=s,e[9]=g,e[10]=p,e[11]=0,e[12]=-(i*X+l*m+s*w),e[13]=-(v*X+y*m+g*w),e[14]=-(o*X+h*m+p*w),e[15]=1,e)}var te=J,D=$,re=T,ae=ee,ie=de,H=typeof window<"u";function de(e,f){var t=f||{};typeof t.noScroll>"u"&&(t.noScroll=t.preventDefault);var n={view:D(new Float32Array(16)),projection:D(new Float32Array(16)),center:new Float32Array(t.center||3),theta:t.theta||0,phi:t.phi||0,distance:Math.log(t.distance||10),eye:new Float32Array(3),up:new Float32Array(t.up||[0,1,0]),fovy:t.fovy||Math.PI/4,near:typeof t.near<"u"?t.near:.01,far:typeof t.far<"u"?t.far:1e3,noScroll:typeof t.noScroll<"u"?t.noScroll:!1,noZoom:typeof t.noZoom<"u"?t.noZoom:!1,flipY:!!t.flipY,dtheta:0,dphi:0,rotationSpeed:typeof t.rotationSpeed<"u"?t.rotationSpeed:1,zoomSpeed:typeof t.zoomSpeed<"u"?t.zoomSpeed:1,renderOnDirty:typeof t.renderOnDirty!==void 0?!!t.renderOnDirty:!1},i=t.element,l=typeof t.damping<"u"?t.damping:.9,s=new Float32Array([1,0,0]),v=new Float32Array([0,0,1]),y=Math.log("minDistance"in t?t.minDistance:.1),g=Math.log("maxDistance"in t?t.maxDistance:1e3),o=0,h=0,p=0;if(H&&t.mouse!==!1){let d=function(){return i?i.offsetWidth:window.innerWidth},c=function(){return i?i.offsetHeight:window.innerHeight};var a=i||e._gl.canvas,X=!1;a.addEventListener("mousedown",function(r){r.button===0&&(X=!0,h=r.clientX,p=r.clientY)}),window.addEventListener("mousemove",function(r){if(X){var u=(r.clientX-h)/d(),M=(r.clientY-p)/c();n.dtheta+=n.rotationSpeed*4*u,n.dphi+=n.rotationSpeed*4*M,n.dirty=!0,h=r.clientX,p=r.clientY}}),window.addEventListener("mouseup",function(r){r.button===0&&(X=!1)});var m=null,w=null,Y=null;a.addEventListener("touchstart",function(r){if(r.touches.length===1)m=r.touches[0].identifier,h=r.touches[0].clientX,p=r.touches[0].clientY,r.preventDefault();else if(r.touches.length===2&&!n.noZoom){m=null;var u=r.touches[0].clientX-r.touches[1].clientX,M=r.touches[0].clientY-r.touches[1].clientY;w=Math.sqrt(u*u+M*M),Y=n.distance,r.preventDefault()}},{passive:!1}),a.addEventListener("touchmove",function(r){if(r.touches.length===1&&m!==null){for(var u=null,M=0;M<r.touches.length;M++)if(r.touches[M].identifier===m){u=r.touches[M];break}if(u){var S=(u.clientX-h)/d(),E=(u.clientY-p)/c();n.dtheta+=n.rotationSpeed*4*S,n.dphi+=n.rotationSpeed*4*E,n.dirty=!0,h=u.clientX,p=u.clientY}r.preventDefault()}else if(r.touches.length===2&&w!==null&&!n.noZoom){var S=r.touches[0].clientX-r.touches[1].clientX,E=r.touches[0].clientY-r.touches[1].clientY,A=Math.sqrt(S*S+E*E),L=w/A;n.distance=Y+Math.log(L)*n.zoomSpeed,n.dirty=!0,r.preventDefault()}},{passive:!1}),a.addEventListener("touchend",function(r){r.touches.length===0?(m=null,w=null,Y=null):r.touches.length===1&&(w=null,Y=null,m=r.touches[0].identifier,h=r.touches[0].clientX,p=r.touches[0].clientY)}),a.addEventListener("touchcancel",function(r){m=null,w=null,Y=null}),n.noZoom||te(a,function(r,u){o+=u/c()*n.zoomSpeed,n.dirty=!0},t.noScroll)}function z(d){var c=d*l;return Math.abs(c)<.1?0:(n.dirty=!0,c)}function b(d,c,r){return Math.min(Math.max(d,c),r)}function F(d){Object.keys(d).forEach(function(_){n[_]=d[_]});var c=n.center,r=n.eye,u=n.up,M=n.dtheta,S=n.dphi;n.theta+=M,n.phi=b(n.phi+S,-Math.PI/2,Math.PI/2),n.distance=b(n.distance+o,y,g),n.dtheta=z(M),n.dphi=z(S),o=z(o);for(var E=n.theta,A=n.phi,L=Math.exp(n.distance),W=L*Math.sin(E)*Math.cos(A),q=L*Math.cos(E)*Math.cos(A),k=L*Math.sin(A),j=0;j<3;++j)r[j]=c[j]+W*v[j]+q*s[j]+k*u[j];ae(n.view,r,c,u)}n.dirty=!0;var P=e({context:Object.assign({},n,{dirty:function(){return n.dirty},projection:function(d){return re(n.projection,n.fovy,d.viewportWidth/d.viewportHeight,n.near,n.far),n.flipY&&(n.projection[5]*=-1),n.projection}}),uniforms:Object.keys(n).reduce(function(d,c){return d[c]=e.context(c),d},{})});function x(d,c){typeof x.dirty<"u"&&(n.dirty=x.dirty||n.dirty,x.dirty=void 0),d&&c&&(n.dirty=!0),!(n.renderOnDirty&&!n.dirty)&&(c||(c=d,d={}),F(d),P(c),n.dirty=!1)}return Object.keys(n).forEach(function(d){x[d]=n[d]}),x.element=i||(H?e._gl.canvas:null),x.taint=function(){n.dirty=!0},x.state=n,x}var fe=N(ie);export{fe as default};
