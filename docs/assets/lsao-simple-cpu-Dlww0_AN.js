function C({terrainData:p,tileSize:c,pixelSize:j,directions:a=[[1,0],[-1,0],[0,1],[0,-1]]}){const u=c+2,w=c*c;if(p.length!==u*u)throw new Error(`Terrain data size mismatch: expected ${u}Ã—${u}, got ${p.length}`);const d=new Float32Array(w);d.fill(0);const B=1/a.length,z=n=>n[0]%c+n[1]*c,m=n=>{const f=[n[0]+1,n[1]+1];return f[0]%u+f[1]*u};for(const n of a)for(let f=0;f<c;f++){let o=[f,f];n[1]===0?o[0]=n[0]<0?c-1:0:n[0]===0&&(o[1]=n[1]<0?c-1:0);const e=[],i=[o[0]-n[0],o[1]-n[1]],T=p[m(i)];e.push([i[0],i[1],T]);for(let I=0;I<c;I++){const $=z(o),A=m(o),M=p[A],s=[o[0],o[1],M],g=e[e.length-1];let t=[g[0]-s[0],g[1]-s[1],g[2]-s[2]],l=t[2]*t[2]/(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);for(l=t[2]>0?l:-l;e.length>1;){const b=e[e.length-2];t=[b[0]-s[0],b[1]-s[1],b[2]-s[2]];let h=t[2]*t[2]/(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);if(h=t[2]>0?h:-h,l>h)break;l=h,e.pop()}const x=e[e.length-1];t=[x[0]-s[0],x[1]-s[1],x[2]-s[2]];const r=[t[0],t[1],t[2]/j],k=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]),q=B*Math.exp(-r[2]/k);d[$]+=q,e.push(s),o=[o[0]+n[0],o[1]+n[1]]}}return d}export{C as computeSimpleLSAOCPU};
