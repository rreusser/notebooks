function p(t,n,a,l){const[u,h,r]=l;t[0]=n[2],t[1]=n[3],t[4]=n[6],t[5]=n[7],t[8]=n[10],t[9]=n[11];let o=n[4]-n[0],s=n[5]-n[1],c=Math.pow(o*o+s*s,1.5);o/=c,s/=c,t[2]=o*h,t[3]=s*h,t[6]=-o*u,t[7]=-s*u,o=n[8]-n[0],s=n[9]-n[1],c=Math.pow(o*o+s*s,1.5),o/=c,s/=c,t[2]+=o*r,t[3]+=s*r,t[10]=-o*u,t[11]=-s*u,o=n[8]-n[4],s=n[9]-n[5],c=Math.pow(o*o+s*s,1.5),o/=c,s/=c,t[6]+=o*r,t[7]+=s*r,t[10]-=o*h,t[11]-=s*h}function d(t,n,a){const[l,u,h]=n,r=a*9,o=(t[r]-t[r+3])/Math.sqrt(2),s=(t[r+1]-t[r+4])/Math.sqrt(2),c=((l*t[r]+u*t[r+3])/(l+u)-t[r+6])*2/Math.sqrt(6),e=((l*t[r+1]+u*t[r+4])/(l+u)-t[r+7])*2/Math.sqrt(6),i=o*o+s*s,f=c*c+e*e,m=i+f;return[2*(o*c+s*e)/m,(f-i)/m,2*(o*e-s*c)/m]}function M(t){function n(e,i){const f=Math.atan2(e,i);return Math.floor((f/(2*Math.PI)+1)%1*3)}const a=[1];let l=0;for(let e=0;e<t.length;e+=3){const i=t[e+2];l*i<0&&a.push(n(t[e],t[e+1])),l=i}a[a.length-1]!==2&&a.push(2);const u=[[null,"F","FA"],["B",null,"A"],["EB","E",null]],h=[[null,"D","DG"],["H",null,"G"],["CH","C",null]],r=[];for(let e=0;e<a.length-1;e++)r.push((e%2===0?h:u)[a[e]][a[e+1]]);const o=r.join(""),s={AC:"b",GE:"B",BD:"a",HF:"A"},c=[];for(let e=0;e<o.length;e+=2)c.push(s[o.substr(e,2)]);return c.join("")}function v(t,n){const a={tolerance:n.tolerance||1e-9,tLimit:n.period},l={t:0,y:n.y0.slice()},u={position:[],t:[]};function h(c,e){u.t.push(c),u.position.push(e[0],e[1],c,e[4],e[5],c,e[8],e[9],c)}h(l.t,l.y);let r=0;const o=n.m,s=(c,e,i)=>p(c,e,i,o);for(;r++<1e6&&!l.limitReached;)t(l,s,a),h(l.t,l.y);return u}function F(t,n,a){if(!t)return null;const l=t.x,u=t.v,h=t.m||[1,1,1];let r=n;/i\.c\./.test(r)?r=r.replace(/ i\.c\./,"^{i.c.}").replace(/.([0-9]+)/,"_{$1}"):/^F/.test(r)&&(r=r.replace(/^F([0-9]+)/,"F_{$1}"));const o=h.reduce((c,e)=>c+e,0),s=h.map(c=>Math.pow(c/o*3,.5));return{name:r,y0:[l[0][0],l[0][1],u[0][0],u[0][1],l[1][0],l[1][1],u[1][0],u[1][1],l[2][0],l[2][1],u[2][0],u[2][1]],tolerance:t.tolerance||1e-9,period:t.T,m:h,pointSize:s,colors:a}}function g(t){const n={};return t.replace(/^#/,"").split("&").forEach(a=>{const[l,u]=a.split("=");l&&(n[l]=decodeURIComponent(u||""))}),n}export{M as computeFreeGroupWord,d as computeShape,g as decodeHash,v as integrateTrajectory,F as parseInitialConditions,p as planarThreeBodyDerivative};
