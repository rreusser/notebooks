import E from"./compute-winding-2zH5-t52.js";function G(i,h,a){for(let c=0;c<a;c++)h[c]=c;for(let c=0;c<a;c++){let e=0,r=c;for(let t=c;t<a;t++){const s=Math.abs(i[t*a+c]);s>e&&(e=s,r=t)}if(r!==c){const t=h[c];h[c]=h[r],h[r]=t;for(let s=0;s<a;s++){const M=i[c*a+s];i[c*a+s]=i[r*a+s],i[r*a+s]=M}}for(let t=c+1;t<a;t++){i[t*a+c]/=i[c*a+c];for(let s=c+1;s<a;s++)i[t*a+s]-=i[t*a+c]*i[c*a+s]}}}function H(i,h,a,c,e){const r=new Float64Array(e);for(let t=0;t<e;t++){r[t]=a[h[t]];for(let s=0;s<t;s++)r[t]-=i[t*e+s]*r[s]}for(let t=e-1;t>=0;t--){c[t]=r[t];for(let s=t+1;s<e;s++)c[t]-=i[t*e+s]*c[s];c[t]/=i[t*e+t]}}function K({geometry:i,kuttaCondition:h=!0,vInf:a,alpha:c}={}){const{x:e,y:r}=i,t=[],s=[],M=[],n=e.length-1;for(let o=0;o<n;o++){s[o]=.5*(e[o]+e[o+1]),M[o]=.5*(r[o]+r[o+1]);const y=r[o+1]-r[o],l=e[o+1]-e[o];t[o]=Math.atan2(y,l)}const f=h?n+1:n,j=new Float64Array(f*f),w=new Float64Array(f),g=c*Math.PI/180,D=E(e,r);for(let o=0;o<n;o++){const y=t[o];for(let l=0;l<n;l++){const P=Math.sqrt((s[o]-e[l])**2+(M[o]-r[l])**2),S=Math.sqrt((s[o]-e[l+1])**2+(M[o]-r[l+1])**2),I=t[l];let d=Math.PI*D;if(o!==l){const V=s[o]-e[l],q=s[o]-e[l+1],v=M[o]-r[l],z=M[o]-r[l+1],W=V*z-q*v,B=q*V+z*v;d=Math.atan2(W,B)}const u=Math.sin(y-I),m=Math.cos(y-I),p=Math.log(S/P),x=.5/Math.PI;j[o*f+l]=x*(u*p+m*d),h&&(j[o*f+n]+=x*(m*p-u*d),(o===0||o===n-1)&&(j[n*f+l]+=x*(u*d-m*p),j[n*f+n]+=x*(u*p+m*d)))}w[o]=a*Math.sin(y-g)}h&&(w[n]=-a*(Math.cos(t[0]-g)+Math.cos(t[n-1]-g)));const b=new Int32Array(f);G(j,b,f);const F=new Float64Array(f);return H(j,b,w,F,f),{data:F,shape:[f],get(o){return F[o]}}}export{K as default};
