import{d as l,_ as m}from"./index-ByB2dbry.js";import"./comments-I77vOiCB.js";l({root:document.getElementById("cell-42"),expanded:[],variables:[]},{id:42,body:(e,t,o,a)=>{const i=e`<div class="plot-controls"></div>`;function r(c){return i.appendChild(c),t.input(c)}const n=r(o.range([0,1],{label:"Shading opacity",value:1,step:.01})),s=r(o.range([0,1],{label:"Shading contrast",value:.35,step:.01})),u=r(o.range([0,1],{label:"Grid intensity",value:.1,step:.01}));return a(i),{controlsContainer:i,ctrl:r,shadingOpacity:n,shadingContrast:s,gridIntensity:u}},inputs:["html","Generators","Inputs","display"],outputs:["controlsContainer","ctrl","shadingOpacity","shadingContrast","gridIntensity"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-4"),expanded:[],variables:[]},{id:4,body:(e,t,o,a,i,r,n)=>{const s=e`<figure>
  ${t.element}
  <figcaption>Drag points to adjust values. Use mouse wheel to zoom, drag to pan.</figcaption>
</figure>`;return o(a(s,{width:Math.min(i,640),height:Math.min(480,i),toggleOffset:[-15,-33],controls:".plot-controls",onResize(u,c,y){t.resize(c,y),r.updateScales(t.elements.plot.scale("x"),t.elements.plot.scale("y")),n.dirty=!0}})),{figure:s}},inputs:["html","stack","display","expandable","width","axes","regl"],outputs:["figure"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-6"),expanded:[],variables:[]},{id:6,body:()=>({params:{shadingOpacity:1,gridIntensity:.1,shadingContrast:.35}}),inputs:[],outputs:["params"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-17"),expanded:[],variables:[]},{id:17,body:(e,t,o,a,i)=>{e.shadingOpacity=t,e.gridIntensity=o,e.shadingContrast=a,i.dirty=!0},inputs:["params","shadingOpacity","gridIntensity","shadingContrast","regl"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-39"),expanded:[],variables:[]},{id:39,body:async()=>{const[{default:e},{createElementStack:t},{reglElement:o,reglAxesViewport:a},{createZoomableAxes:i},{expandable:r}]=await Promise.all([m(()=>import("https://cdn.jsdelivr.net/npm/regl@2.1.1/+esm"),[]).then(n=>{if(!("default"in n))throw new SyntaxError("export 'default' not found");return n}),m(()=>import("./element-stack-BU40TvN2.js"),[]).then(n=>{if(!("createElementStack"in n))throw new SyntaxError("export 'createElementStack' not found");return n}),m(()=>import("./regl-canvas-4j8SAjSv.js"),[]).then(n=>{if(!("reglElement"in n))throw new SyntaxError("export 'reglElement' not found");if(!("reglAxesViewport"in n))throw new SyntaxError("export 'reglAxesViewport' not found");return n}),m(()=>import("./zoomable-axes-BfGyq1bg.js"),[]).then(n=>{if(!("createZoomableAxes"in n))throw new SyntaxError("export 'createZoomableAxes' not found");return n}),m(()=>import("./expandable-dZkDG0zz.js"),[]).then(n=>{if(!("expandable"in n))throw new SyntaxError("export 'expandable' not found");return n})]);return{createREGL:e,createElementStack:t,reglElement:o,reglAxesViewport:a,createZoomableAxes:i,expandable:r}},inputs:[],outputs:["createREGL","createElementStack","reglElement","reglAxesViewport","createZoomableAxes","expandable"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-7"),expanded:[],variables:[]},{id:7,body:(e,t,o,a,i)=>({stack:e({layers:[{id:"regl",element:t(o,{extensions:["OES_standard_derivatives"],attributes:{depthStencil:!1,preserveDrawingBuffer:!0}})},{id:"plot",element:({width:n,height:s})=>a(n,s)},{id:"svg",element:({current:n,width:s,height:u})=>(n?i.select(n):i.create("svg")).attr("width",s).attr("height",u).node()}]})}),inputs:["createElementStack","reglElement","createREGL","createPlot","d3"],outputs:["stack"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-21"),expanded:[],variables:[]},{id:21,body:e=>{function t(o,a,i=[-2,2],r=[-2,2]){return e.plot({width:o,height:a,marginTop:10,marginRight:10,marginLeft:40,marginBottom:20,style:{backgroundColor:"transparent",maxWidth:"none",position:"absolute"},x:{domain:i,tickSpacing:100},y:{domain:r,tickSpacing:100},marks:[e.ruleX([0],{stroke:"#0002"}),e.ruleY([0],{stroke:"#0002"})]})}return{createPlot:t}},inputs:["Plot"],outputs:["createPlot"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-8"),expanded:[],variables:[]},{id:8,body:(e,t,o,a,i)=>({axes:e({d3:t,element:o.elements.svg,xScale:o.elements.plot.scale("x"),yScale:o.elements.plot.scale("y"),aspectRatio:1,onChange:({xDomain:n,yDomain:s})=>{a.dirty=!0;const u=i(o.width,o.height,n,s);o.elements.plot.replaceWith(u),o.elements.plot=u,o.dispatchEvent(new CustomEvent("update"))}})}),inputs:["createZoomableAxes","d3","stack","regl","createPlot"],outputs:["axes"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-9"),expanded:[],variables:[]},{id:9,body:(e,t)=>e`Next, we wire up some actual math. As a test case, we render a [domain coloring](https://en.wikipedia.org/wiki/Domain_coloring) of a Möbius transformation. The function maps complex numbers according to

${t.block`f(z) = \frac{(z - a)(b - m)}{(z - b)(a - m)}`}

where ${t`a`}, ${t`m`}, and ${t`b`} are control points you can drag to explore the transformation. By construction, ${t`f(a) = 0`}, ${t`f(b) = \infty`}, and ${t`f(m) = 1`}. Möbius transformations are conformal (angle-preserving) and map circles to circles. Neat!`,inputs:["md","tex"],outputs:[],output:void 0,assets:void 0,autodisplay:!0,autoview:!1,automutable:void 0});l({root:document.getElementById("cell-10"),expanded:[],variables:[]},{id:10,body:()=>({controlPoints:{a:{x:-1,y:.5},m:{x:0,y:0},b:{x:1,y:-.5}}}),inputs:[],outputs:["controlPoints"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-25"),expanded:[],variables:[]},{id:25,body:(e,t,o,a,i)=>{const r=e.select(t.elements.svg),n=r.selectAll("defs").data([0]).join("defs"),s=n.selectAll("clipPath#viewport-clip").data([0]).join("clipPath").attr("id","viewport-clip").selectAll("rect").data([0]).join("rect"),u=r.selectAll("g.clipped").data([0]).join("g").attr("class","clipped").attr("clip-path","url(#viewport-clip)"),c=[{id:"a",point:o.a,color:"rgb(51, 85, 238)",label:"a"},{id:"m",point:o.m,color:"rgb(51, 85, 238)",label:"m"},{id:"b",point:o.b,color:"rgb(51, 85, 238)",label:"b"}],y=u.selectAll("circle.control").data(c,d=>d.id).join("circle").attr("class","control").attr("r",6).attr("fill",d=>d.color).attr("stroke","#fff").attr("stroke-width",2).attr("cursor","move").call(e.drag().on("start",function(){e.select(this).attr("cursor","grabbing")}).on("drag",function(d,p){p.point.x=a.xScale.invert(d.x),p.point.y=a.yScale.invert(d.y),g(),i.dirty=!0}).on("end",function(){e.select(this).attr("cursor","move")})),b=u.selectAll("text.label").data(c,d=>d.id).join("text").attr("class","label").attr("text-anchor","middle").attr("font-family","serif").attr("font-size","18px").attr("font-style","italic").attr("fill","#333").style("text-shadow",[[-1,0,2.5],[1,0,2.5],[0,1,2.5],[0,-1,2.5]].map(([d,p,v])=>`${d}px ${p}px ${v}px white`).join(", ")).text(d=>d.label);function g(){const[d,p]=a.xRange,[v,h]=a.yRange;s.attr("x",Math.min(d,p)).attr("y",Math.min(v,h)).attr("width",Math.abs(p-d)).attr("height",Math.abs(h-v)),y.attr("cx",f=>a.xScale(f.point.x)).attr("cy",f=>a.yScale(f.point.y)),b.attr("x",f=>a.xScale(f.point.x)+8).attr("y",f=>a.yScale(f.point.y)+18)}return g(),t.addEventListener("update",g),{svg:r,defs:n,clipRect:s,clippedGroup:u,circleData:c,circles:y,labels:b,updatePositions:g}},inputs:["d3","stack","controlPoints","axes","regl"],outputs:["svg","defs","clipRect","clippedGroup","circleData","circles","labels","updatePositions"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-11"),expanded:[],variables:[]},{id:11,body:e=>({regl:e.elements.regl.value}),inputs:["stack"],outputs:["regl"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-12"),expanded:[],variables:[]},{id:12,body:async(e,t,o,a)=>{const{createPolarDomainColoringShader:i}=await m(()=>import("./domain-coloring-CaVbKgcW.js"),[]).then(n=>{if(!("createPolarDomainColoringShader"in n))throw new SyntaxError("export 'createPolarDomainColoringShader' not found");return n}),r=e({vert:`
    precision highp float;
    attribute vec2 uv;
    varying vec2 z;
    uniform mat4 viewInverse;
    void main () {
      z = (viewInverse * vec4(uv, 0, 1)).xy;
      gl_Position = vec4(uv, 0, 1);
    }`,frag:`
    #extension GL_OES_standard_derivatives : enable
    precision highp float;
    varying vec2 z;
    uniform vec2 a, m, b;
    uniform float pixelRatio;
    uniform float uShadingOpacity, uGridIntensity, uShadingContrast;

    vec2 cmul(vec2 a, vec2 b) { return vec2(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x); }
    vec2 cdiv(vec2 a, vec2 b) { return vec2(a.x * b.x + a.y * b.y, a.y * b.x - a.x * b.y) / dot(b, b); }
    vec2 f(vec2 z) { return cdiv(cmul(z - a, b - m), cmul(z - b, a - m)); }

    ${i()}

    void main () {
      vec2 w = f(z);

      vec4 color = domainColoring(
        vec4(w, fwidth(w) * pixelRatio),
        vec2(2.0, 2.0),    // steps
        vec2(0.1),         // scale
        vec2(uGridIntensity),         // gridOpacity
        vec2(uShadingOpacity * uShadingContrast),  // shadingOpacity
        0.25,              // lineWidth
        0.4,               // lineFeather
        vec3(0.0),         // gridColor
        4.0                // contrastPower
      );

      gl_FragColor = vec4(color.rgb, 1.0);
    }`,uniforms:{viewInverse:e.prop("viewInverse"),pixelRatio:e.context("pixelRatio"),a:e.prop("a"),m:e.prop("m"),b:e.prop("b"),uShadingOpacity:()=>t.shadingOpacity,uGridIntensity:()=>t.gridIntensity,uShadingContrast:()=>t.shadingContrast},attributes:{uv:[-4,-4,4,-4,0,4]},depth:{enable:!1},scissor:{enable:!0,box:o(a)},viewport:o(a),count:3});return{createPolarDomainColoringShader:i,drawGradient:r}},inputs:["regl","params","reglAxesViewport","axes"],outputs:["createPolarDomainColoringShader","drawGradient"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-14"),expanded:[],variables:[]},{id:14,body:(e,t,o,a,i)=>{e.dirty=!0;let r=e.frame(()=>{try{if(!e.dirty)return;t({viewInverse:o.viewInverse,a:[a.a.x,a.a.y],m:[a.m.x,a.m.y],b:[a.b.x,a.b.y]}),e.dirty=!1}catch{r?.cancel(),r=void 0}});return i.then(()=>r?.cancel()),{loop:r}},inputs:["regl","drawGradient","axes","controlPoints","invalidation"],outputs:["loop"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});l({root:document.getElementById("cell-15"),expanded:[],variables:[]},{id:15,body:async()=>{const{collapseCodeBlocks:e}=await m(()=>import("./collapsible-code-B4YhJ-0K.js"),[]).then(t=>{if(!("collapseCodeBlocks"in t))throw new SyntaxError("export 'collapseCodeBlocks' not found");return t});return e({maxHeight:600}),{collapseCodeBlocks:e}},inputs:[],outputs:["collapseCodeBlocks"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});
