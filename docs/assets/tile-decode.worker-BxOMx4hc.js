(function(){"use strict";function c(o,l,f){const e=new Float32Array(l*f);let n=1/0,a=-1/0;for(let t=0;t<l*f;t++){const i=t*4,r=-1e4+(o[i]*65536+o[i+1]*256+o[i+2])*.1;e[t]=r,r<n&&(n=r),r>a&&(a=r)}return{elevations:e,minElevation:n,maxElevation:a}}function d(o,l,f){const e=new Float32Array(264196);let n=1/0,a=-1/0;for(let t=0;t<512;t++)for(let i=0;i<512;i++){const r=(t*512+i)*4,s=o[r]*256+o[r+1]+o[r+2]/256-32768;e[(t+1)*514+(i+1)]=s,s<n&&(n=s),s>a&&(a=s)}for(let t=1;t<=512;t++)e[t*514]=2*e[t*514+1]-e[t*514+2];for(let t=1;t<=512;t++)e[t*514+513]=2*e[t*514+512]-e[t*514+511];for(let t=0;t<514;t++)e[t]=2*e[514+t]-e[514*2+t];for(let t=0;t<514;t++)e[513*514+t]=2*e[512*514+t]-e[511*514+t];return{elevations:e,minElevation:n,maxElevation:a}}function y(o){const f=new Uint8Array(1184256),e=new Uint8Array(o.buffer,o.byteOffset,o.byteLength);for(let n=0;n<514;n++)f.set(e.subarray(n*514*4,(n+1)*514*4),n*2304);return f}self.onmessage=o=>{const{type:l,id:f,pixels:e,width:n,height:a}=o.data,{elevations:t,minElevation:i,maxElevation:r}=l==="decode-terrain-rgb"?c(e,n,a):d(e),s=y(t);self.postMessage({id:f,elevations:t,paddedData:s,minElevation:i,maxElevation:r},[t.buffer,s.buffer])}})();
