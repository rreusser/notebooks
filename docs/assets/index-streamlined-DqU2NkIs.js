import{_ as b,d as g}from"./index-Bvdv0JJ6.js";(window.location.hostname==="localhost"||window.location.hostname.match(/127\.0\.0\.1/))&&b(async()=>{const{main:r}=await import("./index-Bvdv0JJ6.js").then(c=>c.i);return{main:r}},[]).then(({main:r})=>{window.__observableRuntime=r,console.log("[DebugClient] Runtime module exposed as window.__observableRuntime"),b(()=>import("./debug-client-BJyqFSh-.js"),[])});g({root:document.getElementById("cell-1"),expanded:[],variables:[]},{id:1,body:async()=>{const[{getTerrainTile:r,readImageData:c,decodeTerrainData:m},{getParentTilesAtLevel:p,assembleParentTileBufferMultiLevel:s},{computeLSAOCPU:u},{calculateLevelInfo:t}]=await Promise.all([b(()=>import("./main-D-GlyvSx.js"),[]).then(e=>{if(!("getTerrainTile"in e))throw new SyntaxError("export 'getTerrainTile' not found");if(!("readImageData"in e))throw new SyntaxError("export 'readImageData' not found");if(!("decodeTerrainData"in e))throw new SyntaxError("export 'decodeTerrainData' not found");return e}),b(()=>import("./parent-tile-assembly-multi-level-BPsu5Z-Z.js"),[]).then(e=>{if(!("getParentTilesAtLevel"in e))throw new SyntaxError("export 'getParentTilesAtLevel' not found");if(!("assembleParentTileBufferMultiLevel"in e))throw new SyntaxError("export 'assembleParentTileBufferMultiLevel' not found");return e}),b(()=>import("./lsao-cpu-D5hqpa4b.js"),[]).then(e=>{if(!("computeLSAOCPU"in e))throw new SyntaxError("export 'computeLSAOCPU' not found");return e}),b(()=>import("./lsao-pipeline-DMZya29M.js"),[]).then(e=>{if(!("calculateLevelInfo"in e))throw new SyntaxError("export 'calculateLevelInfo' not found");return e})]);return{getTerrainTile:r,readImageData:c,decodeTerrainData:m,getParentTilesAtLevel:p,assembleParentTileBufferMultiLevel:s,computeLSAOCPU:u,calculateLevelInfo:t}},inputs:[],outputs:["getTerrainTile","readImageData","decodeTerrainData","getParentTilesAtLevel","assembleParentTileBufferMultiLevel","computeLSAOCPU","calculateLevelInfo"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-3"),expanded:[],variables:[]},{id:3,body:()=>({coords:{x:795,y:1594,z:12}}),inputs:[],outputs:["coords"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-4"),expanded:[],variables:[]},{id:4,body:(r,c)=>({numLevelsInput:r(c.range([1,3],{value:1,step:1,label:"Number of parent levels"}))}),inputs:["view","Inputs"],outputs:["numLevelsInput"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-5"),expanded:[],variables:[]},{id:5,body:async(r,c,m,p)=>{const s=await r(c),u=m(s.img),t=p(u);let e=1/0,o=-1/0;for(let n=0;n<t.length;n++)t[n]<e&&(e=t[n]),t[n]>o&&(o=t[n]);const i=512,l=1,a=i+2*l,f=new Float32Array(a*a);for(let n=0;n<i;n++)for(let d=0;d<i;d++){const x=(n+s.buffer)*s.width+(d+s.buffer),v=(n+l)*a+(d+l);f[v]=t[x]}for(let n=0;n<a;n++)f[n]=f[a+n],f[(a-1)*a+n]=f[(a-2)*a+n];for(let n=0;n<a;n++)f[n*a]=f[n*a+1],f[n*a+(a-1)]=f[n*a+(a-2)];return{targetTile:s,imageData:u,elevations:t,elevMin:e,elevMax:o,tileSize:i,buffer:l,bufferedSize:a,bufferedData:f}},inputs:["getTerrainTile","coords","readImageData","decodeTerrainData"],outputs:["targetTile","imageData","elevations","elevMin","elevMax","tileSize","buffer","bufferedSize","bufferedData"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-7"),expanded:[],variables:[]},{id:7,body:(r,c,m,p,s,u,t)=>{const e=document.createElement("canvas");e.width=512,e.height=512;const o=e.getContext("2d"),i=o.createImageData(512,512);for(let l=0;l<512;l++)for(let a=0;a<512;a++){const f=(l+r.buffer)*r.width+(a+r.buffer),n=l*512+a,d=(c[f]-m)/(p-m),x=Math.floor(d*180+75),v=Math.floor(d*140+80),y=Math.floor((1-d)*120+60);i.data[n*4]=x,i.data[n*4+1]=v,i.data[n*4+2]=y,i.data[n*4+3]=255}return o.putImageData(i,0,0),s(u`<div>
  <div style="margin-bottom: 8px; font-family: sans-serif; font-size: 13px; color: #666;">
    Target tile ${t.z}/${t.x}/${t.y} | Elevation: ${m.toFixed(0)}m to ${p.toFixed(0)}m
  </div>
  ${e}
</div>`),{canvas:e,ctx:o,imgData:i}},inputs:["targetTile","elevations","elevMin","elevMax","display","html","coords"],outputs:["canvas","ctx","imgData"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-8"),expanded:[],variables:[]},{id:8,body:async(r,c,m,p,s,u,t,e)=>{const o=[],i=[];for(let l=1;l<=r;l++){const a=-l,f=c(m,a),n=[];for(const x of f){const v=await p(x),y=s(v.img),h=u(y);n.push({data:h,width:v.width,height:v.height,tileSize:v.tileSize,role:x.role})}const d=t({targetTile:m,parentTiles:n,deltaZ:a,tileSize:512});o.push(d.buffer),i.push(e(a,512))}return{parentLevelsData:o,levelInfo:i}},inputs:["numLevelsInput","getParentTilesAtLevel","coords","getTerrainTile","readImageData","decodeTerrainData","assembleParentTileBufferMultiLevel","calculateLevelInfo"],outputs:["parentLevelsData","levelInfo"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-10"),expanded:[],variables:[]},{id:10,body:(r,c,m,p)=>{const s=r`<div style="display: flex; flex-direction: column; gap: 24px;"></div>`;for(let u=0;u<c.length;u++){const t=m[u],e=c[u];let o=1/0,i=-1/0;for(let d=0;d<e.length;d++)e[d]<o&&(o=e[d]),e[d]>i&&(i=e[d]);const l=document.createElement("canvas");l.width=t.bufferSize,l.height=t.bufferSize;const a=l.getContext("2d"),f=a.createImageData(t.bufferSize,t.bufferSize);for(let d=0;d<t.bufferSize;d++)for(let x=0;x<t.bufferSize;x++){const v=d*t.bufferSize+x,y=(e[v]-o)/(i-o),h=Math.floor(y*180+75),w=Math.floor(y*140+80),I=Math.floor((1-y)*120+60);f.data[v*4]=h,f.data[v*4+1]=w,f.data[v*4+2]=I,f.data[v*4+3]=255}a.putImageData(f,0,0),a.strokeStyle="#ca4747",a.lineWidth=2,a.strokeRect(t.targetOffset[0],t.targetOffset[1],512/t.scale,512/t.scale);const n=r`<div>
    <div style="margin-bottom: 8px; font-family: sans-serif; font-size: 13px; color: #666;">
      <strong>Level ${u+1} (z-${u+1})</strong>: ${t.bufferSize}×${t.bufferSize} assembly,
      scale ${t.scale}:1 (target shown in red)
    </div>
    ${l}
    <div style="margin-top: 8px; font-family: sans-serif; font-size: 12px; color: #888;">
      Target region: ${(512/t.scale).toFixed(0)}×${(512/t.scale).toFixed(0)} pixels at this resolution
    </div>
  </div>`;s.appendChild(n)}return p(s),{container:s}},inputs:["html","parentLevelsData","levelInfo","display"],outputs:["container"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-12"),expanded:[],variables:[]},{id:12,body:(r,c,m,p,s)=>{const t=78271.517578125/Math.pow(2,r.z),e=performance.now(),o=c({targetData:m,parentLevels:p,levelInfo:s,tileSize:512,pixelSize:t,directions:[[1,0],[-1,0],[0,1],[0,-1]]}),i=performance.now()-e;let l=1/0,a=-1/0,f=0;for(let d=0;d<o.length;d++)l=Math.min(l,o[d]),a=Math.max(a,o[d]),f+=o[d];const n={min:l,max:a,mean:f/o.length};return{EARTH_CIRCUMFERENCE:40075017,pixelSize:t,startTime:e,lsaoResult:o,lsaoTime:i,min:l,max:a,sum:f,lsaoStats:n}},inputs:["coords","computeLSAOCPU","bufferedData","parentLevelsData","levelInfo"],outputs:["EARTH_CIRCUMFERENCE","pixelSize","startTime","lsaoResult","lsaoTime","min","max","sum","lsaoStats"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-13"),expanded:[],variables:[]},{id:13,body:(r,c,m,p,s,u)=>{const t=document.createElement("canvas");t.width=512,t.height=512;const e=t.getContext("2d"),o=e.createImageData(512,512);for(let i=0;i<r.length;i++){const l=Math.floor(Math.min(Math.max(r[i],0),1)*255);o.data[i*4]=l,o.data[i*4+1]=l,o.data[i*4+2]=l,o.data[i*4+3]=255}return e.putImageData(o,0,0),c(m`<div>
  <div style="margin-bottom: 8px; font-family: sans-serif; font-size: 13px; color: #666;">
    <strong>${p} parent level${p>1?"s":""}</strong> |
    Range: ${s.min.toFixed(3)} to ${s.max.toFixed(3)} |
    Mean: ${s.mean.toFixed(3)} |
    Time: ${u.toFixed(1)}ms (CPU)
  </div>
  ${t}
</div>`),{canvas:t,ctx:e,imageData:o}},inputs:["lsaoResult","display","html","numLevelsInput","lsaoStats","lsaoTime"],outputs:["canvas","ctx","imageData"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});g({root:document.getElementById("cell-15"),expanded:[],variables:[]},{id:15,body:(r,c,m)=>{const p=[],s=512*(1+Math.pow(2,r));let u=512;for(let l=0;l<r;l++){const a=Math.pow(2,l+1);u+=512/a}const t=document.createElement("canvas");t.width=512,t.height=300;const e=t.getContext("2d");e.fillStyle="#f9f9f9",e.fillRect(0,0,512,300);const o=400/Math.max(s,u);e.fillStyle="#e74c3c",e.fillRect(50,80,s*o,40),e.fillStyle="#333",e.font="13px sans-serif",e.fillText(`Current: ${s}px`,60,105),e.fillStyle="#27ae60",e.fillRect(50,150,u*o,40),e.fillStyle="#333",e.fillText(`Correct: ${u.toFixed(0)}px`,60,175);const i=((s-u)/s*100).toFixed(1);return e.fillStyle="#666",e.font="14px sans-serif",e.fillText(`Efficiency improvement: ${i}% fewer pixels to process`,50,230),c(m`<div>
  <div style="margin-bottom: 8px; font-family: sans-serif; font-size: 13px; color: #666;">
    <strong>Sweep Size Comparison</strong>
  </div>
  ${t}
  <div style="margin-top: 8px; font-family: sans-serif; font-size: 12px; color: #888;">
    The current implementation processes ${(s/u).toFixed(2)}× more pixels than necessary!
  </div>
</div>`),{analysis:p,currentSweepSize:s,correctSweepSize:u,canvas:t,ctx:e,scale:o,efficiency:i}},inputs:["numLevelsInput","display","html"],outputs:["analysis","currentSweepSize","correctSweepSize","canvas","ctx","scale","efficiency"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});
